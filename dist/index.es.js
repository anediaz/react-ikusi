import n from"@babel/runtime/helpers/taggedTemplateLiteralLoose";import e,{useRef as t,useState as i,useEffect as r,Fragment as o}from"react";import l from"prop-types";import a from"underscore";import c,{keyframes as u}from"styled-components";var m,s,d,f,h,g,p,b,x,v,w,E,y,k,C=u(m||(m=n(["\n  0%{\n    transform: rotate(0deg);\n  }\n  50%{\n    transform: rotate(360deg);\n  }\n  100%{\n    transform: rotate(720deg);\n  }\n"]))),z=c.div(s||(s=n(["\n  position: absolute;\n  border: 0.1rem solid;\n  border-radius: 50%;\n  float: left;\n"]))),L=c(z)(d||(d=n(["\n  height: 3rem;\n  width: 3rem;\n  left: calc(50% - 1.5rem);\n  top: calc(50% - 1.5rem);\n  border-color: deepskyblue;\n  border-left: none;\n  animation: "," 8s linear infinite;\n"])),C),P=c(z)(f||(f=n(["\n  height: 2rem;\n  width: 2rem;\n  left: calc(50% - 1rem);\n  top: calc(50% - 1rem);\n  border-color: deeppink;\n  border-top: none;\n  animation: "," 3s linear infinite;\n"])),C),W=c(z)(h||(h=n(["\n  height: 1rem;\n  width: 1rem;\n  left: calc(50% - 0.5rem);\n  top: calc(50% - 0.5rem);\n  border-color: lightseagreen;\n  border-right: none;\n  animation: "," 5s linear infinite;\n"])),C),q=function(){return e.createElement("div",{className:"Loader"},e.createElement(L,null),e.createElement(P,null),e.createElement(W,null))},R=c.div(g||(g=n(["\n  display: ",";\n  flex-direction: column;\n  justify-content: center;\n  height: 100%;\n  align-items: center;\n  left: 0px;\n  position: fixed;\n  top: 0px;\n  width: 100%;\n  z-index: 2001;\n  background: rgba(0, 0, 0, 0.8);\n"])),(function(n){return n.isActive?"flex":"none"})),N=c.div(p||(p=n(["\n  width: 100%;\n  overflow: auto;\n  text-align: center;\n"]))),S=c.div(b||(b=n(["\n  text-align: center;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  @media (orientation: landscape) {\n    height: 75%;\n  }\n  @media (orientation: portrait) {\n    max-height: 60%;\n  }\n"]))),j=c.img(x||(x=n(["\n  margin: 0 auto;\n  max-height: 100%;\n  max-width: 80%;\n"]))),B=c.div(v||(v=n(["\n  width: 5%;\n  visibility: ",";\n  @media (orientation: portrait) {\n    margin: 0 auto;\n  }\n"])),(function(n){return n.enabled?"visible":"hidden"})),H=c.span(w||(w=n(["\n  color: white;\n  font-size: ",";\n  opacity: 0.6;\n  @media (max-width: 768px) {\n    font-size: ",";\n  }\n\n  &:hover {\n    cursor: pointer;\n  }\n  @media (min-width: 1920px) {\n    font-size: 125px;\n  }\n"])),(function(n){return"small"===n.fontSize?"35px":"50px"}),(function(n){return"small"===n.fontSize?"35px":"40px"})),T={img:l.string.isRequired,onClose:l.func,onNext:l.func,onPrev:l.func},A=function(n){var t=n.img,i=n.onClose,r=n.onNext,o=n.onPrev;return e.createElement(R,{isActive:Boolean(t)},e.createElement(N,null,e.createElement(H,{onClick:function(){return i()},fontSize:"big"},"Ã—")),e.createElement(S,null,e.createElement(B,{enabled:Boolean(o)},e.createElement(H,{onClick:function(){return o?o():null}},"<")),e.createElement(j,{src:t,alt:""}),e.createElement(B,{enabled:Boolean(r)},e.createElement(H,{onClick:function(){return r?r():null}},">"))))};A.propTypes=T,A.defaultProps={img:null,onClose:function(){}};var O={configurations:l.arrayOf(l.shape({cols:l.number.isRequired,margin:l.number.isRequired,maxWidth:l.number,minWidth:l.number})),photos:l.arrayOf(l.shape({src:l.string.isRequired,width:l.number.isRequired,height:l.number.isRequired,bigSrc:l.string})).isRequired,withLightbox:l.bool,onClickPhoto:l.func},D=c.div(E||(E=n(["\n  margin-top: 0.2rem;\n  width: 100%;\n"]))),I=c.div(y||(y=n(["\n  width: 100%;\n  margin: ",";\n  display: flex;\n  justify-content: space-evenly;\n  text-align: center;\n  height: ",";\n"])),(function(n){return n.margin+"px 0"}),(function(n){return n.height+"px"})),K=c.img(k||(k=n(["\n  height: 100%;\n  width: auto;\n  &:hover {\n    cursor: ",";\n    opacity: 0.5;\n  }\n"])),(function(n){return n.onClick?"pointer":"default"})),F=function(n,e){var t=n.find((function(n){var t=n.minWidth,i=n.maxWidth;return(t&&t<=e||!t)&&(i&&i>=e||!i)}));return{width:e,cols:t.cols||7,margin:t.margin||1}},G=function(n){var l=n.photos,c=n.configurations,u=n.withLightbox,m=n.onClickPhoto,s=t(null),d=i(null),f=d[0],h=d[1],g=i(F(c,window.screen.width)),p=g[0],b=g[1],x=function(){return s.current.offsetWidth||0};r((function(){var n=a.debounce((function(){return b(F(c,x()))}),400);return window.addEventListener("resize",n),b(F(c,x())),function(){return window.removeEventListener("resize",n)}}),[c]);var v,w=function(){return h(null)},E=function(){return 0===f},y=function(){return f===l.length-1},k=function(){return y()?null:h(f+1)},C=function(){return E()?null:h(f-1)},z=function(n){var e=p.width,t=p.cols,i=p.margin,r=0;return n.forEach((function(n){r+=n.width/n.height})),(e-1-t*i*2)/r},L=function(n){for(var e=[].concat(n),t=[];e.length;){var i=e.splice(0,p.cols);t.push({photos:i,lineHeight:z(i)})}return t}(l);return e.createElement(D,{ref:s,onKeyDown:function(n){if(!isNaN(f))switch(n.keyCode){case 37:!E()&&C();break;case 39:!y()&&k();break;case 27:w()}},tabIndex:"0"},l.length?e.createElement(o,null,L.map((function(n,t){return n.lineHeight?e.createElement(I,{height:n.lineHeight,margin:p.margin,key:"line-"+t},n.photos.map((function(n,i){var r=t*p.cols+i;return e.createElement(K,{src:n.src,alt:"",key:"item-"+i,onClick:function(){return function(n,e){u&&h(n),m(e)}(r,n.id)}})}))):e.createElement(q,null)})),u&&null!==f&&e.createElement(A,{img:(v=f,null!==v&&l.length>=v&&l[v]?l[v].bigSrc||l[v].src:null),onClose:w,onNext:y()?null:k,onPrev:E()?null:C})):e.createElement(q,null))};G.propTypes=O,G.defaultProps={configurations:[{maxWidth:340,cols:4,margin:1},{maxWidth:1024,cols:6,margin:1},{minWidth:1025,cols:12,margin:1}],withLightbox:!0,onClickPhoto:function(){}};export default G;
