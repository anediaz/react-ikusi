import n from"@babel/runtime/helpers/taggedTemplateLiteralLoose";import e,{useRef as t,useState as r,useEffect as i,Fragment as o}from"react";import u from"prop-types";import a from"underscore";import c,{keyframes as l}from"styled-components";function f(){var e=n(["\n  height: 1rem;\n  width: 1rem;\n  left: calc(50% - 0.5rem);\n  top: calc(50% - 0.5rem);\n  border-color: lightseagreen;\n  border-right: none;\n  animation: "," 5s linear infinite;\n"]);return f=function(){return e},e}function m(){var e=n(["\n  height: 2rem;\n  width: 2rem;\n  left: calc(50% - 1rem);\n  top: calc(50% - 1rem);\n  border-color: deeppink;\n  border-top: none;\n  animation: "," 3s linear infinite;\n"]);return m=function(){return e},e}function s(){var e=n(["\n  height: 3rem;\n  width: 3rem;\n  left: calc(50% - 1.5rem);\n  top: calc(50% - 1.5rem);\n  border-color: deepskyblue;\n  border-left: none;\n  animation: "," 8s linear infinite;\n"]);return s=function(){return e},e}function d(){var e=n(["\n  position: absolute;\n  border: 0.1rem solid;\n  border-radius: 50%;\n  float: left;\n"]);return d=function(){return e},e}function h(){var e=n(["\n  0%{\n    transform: rotate(0deg);\n  }\n  50%{\n    transform: rotate(360deg);\n  }\n  100%{\n    transform: rotate(720deg);\n  }\n"]);return h=function(){return e},e}var g=l(h()),p=c.div(d()),v=c(p)(s(),g),b=c(p)(m(),g),x=c(p)(f(),g),w=function(){return e.createElement("div",{className:"Loader"},e.createElement(v,null),e.createElement(b,null),e.createElement(x,null))};function E(){var e=n(["\n  color: white;\n  font-size: ",";\n  opacity: 0.6;\n  @media (max-width: 768px) {\n    font-size: ",";\n  }\n\n  &:hover {\n    cursor: pointer;\n  }\n  @media (min-width: 1920px) {\n    font-size: 125px;\n  }\n"]);return E=function(){return e},e}function y(){var e=n(["\n  width: 5%;\n  visibility: ",";\n  @media (orientation: portrait) {\n    margin: 0 auto;\n  }\n"]);return y=function(){return e},e}function k(){var e=n(["\n  margin: 0 auto;\n  max-height: 100%;\n  max-width: 80%;\n"]);return k=function(){return e},e}function C(){var e=n(["\n  text-align: center;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  @media (orientation: landscape) {\n    height: 75%;\n  }\n  @media (orientation: portrait) {\n    max-height: 60%;\n  }\n"]);return C=function(){return e},e}function z(){var e=n(["\n  width: 100%;\n  overflow: auto;\n  text-align: center;\n"]);return z=function(){return e},e}function L(){var e=n(["\n  display: ",";\n  flex-direction: column;\n  justify-content: center;\n  height: 100%;\n  align-items: center;\n  left: 0px;\n  position: fixed;\n  top: 0px;\n  width: 100%;\n  z-index: 2001;\n  background: rgba(0, 0, 0, 0.8);\n"]);return L=function(){return e},e}var W=c.div(L(),(function(n){return n.isActive?"flex":"none"})),q=c.div(z()),R=c.div(C()),N=c.img(k()),P=c.div(y(),(function(n){return n.enabled?"visible":"hidden"})),S=c.span(E(),(function(n){return"small"===n.fontSize?"35px":"50px"}),(function(n){return"small"===n.fontSize?"35px":"40px"})),j={img:u.string.isRequired,onClose:u.func,onNext:u.func,onPrev:u.func},B=function(n){var t=n.img,r=n.onClose,i=n.onNext,o=n.onPrev;return e.createElement(W,{isActive:Boolean(t)},e.createElement(q,null,e.createElement(S,{onClick:function(){return r()},fontSize:"big"},"Ã—")),e.createElement(R,null,e.createElement(P,{enabled:Boolean(o)},e.createElement(S,{onClick:function(){return o?o():null}},"<")),e.createElement(N,{src:t,alt:""}),e.createElement(P,{enabled:Boolean(i)},e.createElement(S,{onClick:function(){return i?i():null}},">"))))};function H(){var e=n(["\n  height: 100%;\n  width: auto;\n  &:hover {\n    cursor: ",";\n    opacity: 0.5;\n  }\n"]);return H=function(){return e},e}function T(){var e=n(["\n  width: 100%;\n  margin: ",";\n  display: flex;\n  justify-content: space-evenly;\n  text-align: center;\n  height: ",";\n"]);return T=function(){return e},e}function A(){var e=n(["\n  margin-top: 0.2rem;\n  width: 100%;\n"]);return A=function(){return e},e}B.propTypes=j,B.defaultProps={img:null,onClose:function(){}};var O={configurations:u.arrayOf(u.shape({cols:u.number.isRequired,margin:u.number.isRequired,maxWidth:u.number,minWidth:u.number})),photos:u.arrayOf(u.shape({src:u.string.isRequired,width:u.number.isRequired,height:u.number.isRequired,bigSrc:u.string})).isRequired,withLightbox:u.bool},D=c.div(A()),I=c.div(T(),(function(n){return n.margin+"px 0"}),(function(n){return n.height+"px"})),K=c.img(H(),(function(n){return n.onClick?"pointer":"default"})),F=function(n,e){var t=n.find((function(n){var t=n.minWidth,r=n.maxWidth;return(t&&t<=e||!t)&&(r&&r>=e||!r)}));return{width:e,cols:t.cols||7,margin:t.margin||1}},G=function(n){var u=n.photos,c=n.configurations,l=n.withLightbox,f=t(null),m=r(null),s=m[0],d=m[1],h=r(F(c,window.screen.width)),g=h[0],p=h[1],v=function(){return f.current.offsetWidth||0};i((function(){var n=a.debounce((function(){return p(F(c,v()))}),400);return window.addEventListener("resize",n),p(F(c,v())),function(){return window.removeEventListener("resize",n)}}),[c]);var b,x=function(){return d(null)},E=function(){return 0===s},y=function(){return s===u.length-1},k=function(){return y()?null:d(s+1)},C=function(){return E()?null:d(s-1)},z=function(n){var e=g.width,t=g.cols,r=g.margin,i=0;return n.forEach((function(n){i+=n.width/n.height})),(e-1-t*r*2)/i},L=function(n){for(var e=[].concat(n),t=[];e.length;){var r=e.splice(0,g.cols);t.push({photos:r,lineHeight:z(r)})}return t}(u);return e.createElement(D,{ref:f,onKeyDown:function(n){if(!isNaN(s))switch(n.keyCode){case 37:!E()&&C();break;case 39:!y()&&k();break;case 27:x()}},tabIndex:"0"},u.length?e.createElement(o,null,L.map((function(n,t){return n.lineHeight?e.createElement(I,{height:n.lineHeight,margin:g.margin,key:"line-"+t},n.photos.map((function(n,r){var i=t*g.cols+r;return e.createElement(K,{src:n.src,alt:"",key:"item-"+r,onClick:l?function(){return d(i)}:null})}))):e.createElement(w,null)})),l&&null!==s&&e.createElement(B,{img:(b=s,null!==b&&u.length>=b&&u[b]?u[b].bigSrc||u[b].src:null),onClose:x,onNext:y()?null:k,onPrev:E()?null:C})):e.createElement(w,null))};G.propTypes=O,G.defaultProps={configurations:[{maxWidth:340,cols:4,margin:1},{maxWidth:1024,cols:6,margin:1},{minWidth:1025,cols:12,margin:1}],withLightbox:!0};export default G;
